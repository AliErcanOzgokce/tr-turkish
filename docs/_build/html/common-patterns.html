<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sık Kullanılan Modeller &mdash; Solidity 0.8.15 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/a4_railroad_diagram.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/toggle.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/js/toggle.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Bilinen Bugların Listesi" href="bugs.html" />
    <link rel="prev" title="Style Guide" href="style-guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #65afff" >
            <a href="index.html">
            <img src="_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.8.15
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Temeller</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction-to-smart-contracts.html">Akıllı Sözleşmelere Giriş</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing-solidity.html">Solidity Derleyicisini Yükleme</a></li>
<li class="toctree-l1"><a class="reference internal" href="solidity-by-example.html">Solidity by Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dil Açıklaması</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="layout-of-source-files.html">Solidity Kaynak Dosyasının Düzeni</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure-of-a-contract.html">Bir Sözleşmenin Yapısı</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Türler</a></li>
<li class="toctree-l1"><a class="reference internal" href="units-and-global-variables.html">Birimler ve Global Olarak Kullanılabilir Değişkenler</a></li>
<li class="toctree-l1"><a class="reference internal" href="control-structures.html">İfadeler ve Kontrol Yapıları</a></li>
<li class="toctree-l1"><a class="reference internal" href="contracts.html">Akıllı Sözleşmeler</a></li>
<li class="toctree-l1"><a class="reference internal" href="assembly.html">Inline Assembly</a></li>
<li class="toctree-l1"><a class="reference internal" href="cheatsheet.html">Kopya Kağıdı</a></li>
<li class="toctree-l1"><a class="reference internal" href="grammar.html">Dilbilgisi (Language Grammar)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Derleyici</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="using-the-compiler.html">Derleyicinin Kullanımı</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysing-compilation-output.html">Analysing the Compiler Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="ir-breaking-changes.html">Solidity IR-based Codegen Changes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dahili</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="internals/layout_in_storage.html">Depolama Alanındaki Durum Değişkenlerinin Düzeni</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/layout_in_memory.html">Bellekteki Düzen</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/layout_in_calldata.html">Çağrı Verilerinin Düzeni</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/variable_cleanup.html">Değişkenlerin Temizlenmesi</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/source_mappings.html">Kaynak Eşlemesi</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/optimizer.html">Optimize Edici</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Sözleşme Meta Verisi</a></li>
<li class="toctree-l1"><a class="reference internal" href="abi-spec.html">Sözleşme ABI Spesifikasyonu</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ek Materyaller</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="050-breaking-changes.html">Solidity v0.5.0 İşleyişi Bozan Değişiklikler</a></li>
<li class="toctree-l1"><a class="reference internal" href="060-breaking-changes.html">Solidity v0.6.0 İşleyişi Bozan Değişiklikler</a></li>
<li class="toctree-l1"><a class="reference internal" href="070-breaking-changes.html">Solidity v0.7.0 İşleyişi Bozan Değişiklikler</a></li>
<li class="toctree-l1"><a class="reference internal" href="080-breaking-changes.html">Solidity v0.8.0 İşleyişi Bozan Değişiklikler</a></li>
<li class="toctree-l1"><a class="reference internal" href="natspec-format.html">NatSpec Formatı</a></li>
<li class="toctree-l1"><a class="reference internal" href="security-considerations.html">Güvenlikle İlgili Değerlendirmeler</a></li>
<li class="toctree-l1"><a class="reference internal" href="smtchecker.html">SMTChecker and Formal Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Kaynaklar</a></li>
<li class="toctree-l1"><a class="reference internal" href="path-resolution.html">Import Path Resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="yul.html">Yul</a></li>
<li class="toctree-l1"><a class="reference internal" href="style-guide.html">Style Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Sık Kullanılan Modeller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sozlesmelerden-para-cekme">Sözleşmelerden Para Çekme</a></li>
<li class="toctree-l2"><a class="reference internal" href="#erisimi-kisitlamak">Erişimi Kısıtlamak</a></li>
<li class="toctree-l2"><a class="reference internal" href="#durum-makinesi">Durum Makinesi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ornek">Örnek</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bugs.html">Bilinen Bugların Listesi</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Katkıda Bulunmak</a></li>
<li class="toctree-l1"><a class="reference internal" href="brand-guide.html">Solidity Marka Kılavuzu</a></li>
<li class="toctree-l1"><a class="reference internal" href="language-influences.html">Language Influences</a></li>
</ul>

    <ul>
        <li>
            <a href="genindex.html">Keyword Index</a>
        </li>
    </ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #65afff" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Solidity</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Sık Kullanılan Modeller</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/common-patterns.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sik-kullanilan-modeller">
<h1>Sık Kullanılan Modeller<a class="headerlink" href="#sik-kullanilan-modeller" title="Permalink to this heading"></a></h1>
<section id="sozlesmelerden-para-cekme">
<span id="withdrawal-pattern"></span><span id="index-0"></span><h2>Sözleşmelerden Para Çekme<a class="headerlink" href="#sozlesmelerden-para-cekme" title="Permalink to this heading"></a></h2>
<p>Bir etkiden sonra önerilen fon gönderme yöntemi, para çekme
modelini kullanmaktır. Bir etki sonucunda, anlaşılması en kolay Ether
gönderme yöntemi doğrudan <code class="docutils literal notranslate"><span class="pre">transfer</span></code> çağrısı olsa da,
potansiyel güvenlik riski oluşturduğundan bu önerilmez. Bu
konuda daha fazla bilgiye <span class="xref std std-ref">Güvenlikle İlgili
Değerlendirmeler</span> sayfasından ulaşabilirsiniz.</p>
<p><cite>King of the Ether &lt;https://www.kingoftheether.com/&gt;</cite>’de
olduğu gibi, amacın “en zengin” olmak için sözleşmeye en fazla
parayı göndermek olduğu bir sözleşmede para çekme modelinin
nasıl kullanıldığına dair uygulamalı bir örnek aşağıda verilmiştir.</p>
<p>Aşağıdaki sözleşmede, artık en zengin olan değilseniz o anda en
zengin olan kişinin fonlarını alırsınız.</p>
<p class="remix-link-container"><a class="remix-link reference external" href="https://remix.ethereum.org/?language=solidity&amp;version=0.8.15&amp;code=Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0zLjAKcHJhZ21hIHNvbGlkaXR5IF4wLjguNDsKCmNvbnRyYWN0IFdpdGhkcmF3YWxDb250cmFjdCB7CiAgICBhZGRyZXNzIHB1YmxpYyByaWNoZXN0OwogICAgdWludCBwdWJsaWMgbW9zdFNlbnQ7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwZW5kaW5nV2l0aGRyYXdhbHM7CgogICAgLy8vIEfDtm5kZXJpbGVuIEV0aGVyIG1pa3RhcsSxIMWfdSBhbmtpIGVuIHnDvGtzZWsKICAgIC8vLyBtaWt0YXJkYW4gecO8a3NlayBkZcSfaWxkaS4KICAgIGVycm9yIE5vdEVub3VnaEV0aGVyKCk7CgogICAgY29uc3RydWN0b3IoKSBwYXlhYmxlIHsKICAgICAgICByaWNoZXN0ID0gbXNnLnNlbmRlcjsKICAgICAgICBtb3N0U2VudCA9IG1zZy52YWx1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBiZWNvbWVSaWNoZXN0KCkgcHVibGljIHBheWFibGUgewogICAgICAgIGlmIChtc2cudmFsdWUgPD0gbW9zdFNlbnQpIHJldmVydCBOb3RFbm91Z2hFdGhlcigpOwogICAgICAgIHBlbmRpbmdXaXRoZHJhd2Fsc1tyaWNoZXN0XSArPSBtc2cudmFsdWU7CiAgICAgICAgcmljaGVzdCA9IG1zZy5zZW5kZXI7CiAgICAgICAgbW9zdFNlbnQgPSBtc2cudmFsdWU7CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXcoKSBwdWJsaWMgewogICAgICAgIHVpbnQgYW1vdW50ID0gcGVuZGluZ1dpdGhkcmF3YWxzW21zZy5zZW5kZXJdOwogICAgICAgIC8vIFRla3JhciBnaXJtZShyZS1lbnRyYW5jeSksIHNhbGTEsXLEsWxhcsSxbsSxIMO2bmxlbWVrIGnDp2luIGfDtm5kZXJpbQogICAgICAgIC8vIMO2bmNlc2luZGUgZ2VyaSDDtmRlbWV5aSBzxLFmxLFybGFtYXnEsSB1bnV0bWF5xLFuCiAgICAgICAgcGVuZGluZ1dpdGhkcmF3YWxzW21zZy5zZW5kZXJdID0gMDsKICAgICAgICBwYXlhYmxlKG1zZy5zZW5kZXIpLnRyYW5zZmVyKGFtb3VudCk7CiAgICB9Cn0="><span class="link-icon"></span><span class="link-text">open in Remix</span></a></p>
<div class="highlight-solidity notranslate"><div class="highlight"><pre><span></span><span class="c1">// SPDX-License-Identifier: GPL-3.0</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.4</span><span class="p">;</span><span class="w"></span>

<span class="k">contract</span><span class="w"> </span><span class="ni">WithdrawalContract</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="k">public </span><span class="nv">richest</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">mostSent</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">mapping</span><span class="w"> </span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span>pendingWithdrawals<span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">/// Gönderilen Ether miktarı şu anki en yüksek</span>
<span class="w">    </span><span class="c1">/// miktardan yüksek değildi.</span>
<span class="w">    </span>error<span class="w"> </span>NotEnoughEther<span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="kt">constructor</span><span class="p">()</span><span class="w"> </span><span class="kt">payable</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>richest<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.sender</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span>mostSent<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">becomeRichest</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">payable</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.value</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span>mostSent<span class="p">)</span><span class="w"> </span>revert<span class="w"> </span>NotEnoughEther<span class="p">();</span><span class="w"></span>
<span class="w">        </span>pendingWithdrawals<span class="p">[</span>richest<span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span>richest<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.sender</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span>mostSent<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">withdraw</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pendingWithdrawals<span class="p">[</span><span class="k">msg.sender</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Tekrar girme(re-entrancy), saldırılarını önlemek için gönderim</span>
<span class="w">        </span><span class="c1">// öncesinde geri ödemeyi sıfırlamayı unutmayın</span>
<span class="w">        </span>pendingWithdrawals<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">payable</span><span class="p">(</span><span class="k">msg.sender</span><span class="p">).</span>transfer<span class="p">(</span>amount<span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Akla daha yatkın olan gönderme modeli aşağıdaki gibidir ama güvenlik açığı içerir:</p>
<p class="remix-link-container"><a class="remix-link reference external" href="https://remix.ethereum.org/?language=solidity&amp;version=0.8.15&amp;code=Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0zLjAKcHJhZ21hIHNvbGlkaXR5IF4wLjguNDsKCmNvbnRyYWN0IFNlbmRDb250cmFjdCB7CiAgICBhZGRyZXNzIHBheWFibGUgcHVibGljIHJpY2hlc3Q7CiAgICB1aW50IHB1YmxpYyBtb3N0U2VudDsKCiAgICAvLy8gR8O2bmRlcmlsZW4gRXRoZXIgbWlrdGFyxLEgxZ91IGFua2kgZW4gecO8a3NlawogICAgLy8vIG1pa3RhcmRhbiB5w7xrc2VrIGRlxJ9pbGRpLgogICAgZXJyb3IgTm90RW5vdWdoRXRoZXIoKTsKCiAgICBjb25zdHJ1Y3RvcigpIHBheWFibGUgewogICAgICAgIHJpY2hlc3QgPSBwYXlhYmxlKG1zZy5zZW5kZXIpOwogICAgICAgIG1vc3RTZW50ID0gbXNnLnZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGJlY29tZVJpY2hlc3QoKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgaWYgKG1zZy52YWx1ZSA8PSBtb3N0U2VudCkgcmV2ZXJ0IE5vdEVub3VnaEV0aGVyKCk7CiAgICAgICAgLy8gQnUgc2F0xLFyIHNvcnVubGFyYSBuZWRlbiBvbGFiaWxpciAoYcWfYcSfxLFkYSBhw6fEsWtsYW5txLHFn3TEsXIpLgogICAgICAgIHJpY2hlc3QudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgICAgICByaWNoZXN0ID0gcGF5YWJsZShtc2cuc2VuZGVyKTsKICAgICAgICBtb3N0U2VudCA9IG1zZy52YWx1ZTsKICAgIH0KfQ=="><span class="link-icon"></span><span class="link-text">open in Remix</span></a></p>
<div class="highlight-solidity notranslate"><div class="highlight"><pre><span></span><span class="c1">// SPDX-License-Identifier: GPL-3.0</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.4</span><span class="p">;</span><span class="w"></span>

<span class="k">contract</span><span class="w"> </span><span class="ni">SendContract</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="nv">payable</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>richest<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">mostSent</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">/// Gönderilen Ether miktarı şu anki en yüksek</span>
<span class="w">    </span><span class="c1">/// miktardan yüksek değildi.</span>
<span class="w">    </span>error<span class="w"> </span>NotEnoughEther<span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="kt">constructor</span><span class="p">()</span><span class="w"> </span><span class="kt">payable</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>richest<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">payable</span><span class="p">(</span><span class="k">msg.sender</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span>mostSent<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">becomeRichest</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">payable</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.value</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span>mostSent<span class="p">)</span><span class="w"> </span>revert<span class="w"> </span>NotEnoughEther<span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Bu satır sorunlara neden olabilir (aşağıda açıklanmıştır).</span>
<span class="w">        </span>richest<span class="p">.</span>transfer<span class="p">(</span><span class="k">msg.value</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span>richest<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">payable</span><span class="p">(</span><span class="k">msg.sender</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span>mostSent<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Bu örnekte, bir saldırgan, <code class="docutils literal notranslate"><span class="pre">richest</span></code>’ın başarısız olan bir receive veya callback fonksiyonuna sahip
bir sözleşmenin adresi olmasına sebep olarak (örneğin, <code class="docutils literal notranslate"><span class="pre">revert()</span></code> kullanarak veya yalnızca, onlara
aktarılan 2300 gas ücretinden daha fazlasını tüketerek) sözleşmeyi kullanılamayacak bir duruma düşürebilir.
Bu şekilde, fonları “zehirlenmiş” sözleşmeye iletmek için <code class="docutils literal notranslate"><span class="pre">transfer</span></code> her çağrıldığında başarısız olur,
dolayısıyla <code class="docutils literal notranslate"><span class="pre">becomeRichest</span></code> fonksiyonu da başarısız olur ve sözleşme sonsuza kadar kilitli / takılı kalır.</p>
<p>Bunun aksine, ilk örnekten “çekme” modelini kullanırsanız saldırgan sözleşmenin kalanındaki işleyişin
değil, yalnızca kendi çekim işleminin başarısız olmasına sebep olabilir.</p>
</section>
<section id="erisimi-kisitlamak">
<span id="index-1"></span><h2>Erişimi Kısıtlamak<a class="headerlink" href="#erisimi-kisitlamak" title="Permalink to this heading"></a></h2>
<p>Erişimi kısıtlamak sözleşmeler için yaygın bir modeldir.
Herhangi bir insanı veya bilgisayarı, işlemlerinizin içeriğini
veya sözleşmenizin durumunu okumak konusunda kesinlikle
kısıtlayamayacağınızı unutmayın. Şifreleme kullanarak bunu
bir miktar zorlaştırabilirsiniz ancak sözleşmenizin veri
okumasına izin verilmişse diğer herkes de okuyacaktır.</p>
<p>Sözleşme durum degişkenlerinin okuma erişimini <strong>diğer sözleşmeler</strong>
ile kısıtlayabilirsiniz. Bu aslında, durum değişkenlerinizi
<code class="docutils literal notranslate"><span class="pre">public</span></code> olarak bildirmediğiniz sürece varsayılandır.</p>
<p>Ayrıca, sözleşmenizin durumunda değişiklik yapabilecek
kişileri kısıtlayabilir veya sözleşmenizin fonksiyonlarını
çağırabilirsiniz; bu bölümün konusu da budur.</p>
<p id="index-2"><strong>Fonksiyon modifier’larının</strong> kullanımı bu
kısıtlamaları oldukça okunur hale getirir.</p>
<p class="remix-link-container"><a class="remix-link reference external" href="https://remix.ethereum.org/?language=solidity&amp;version=0.8.15&amp;code=Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0zLjAKcHJhZ21hIHNvbGlkaXR5IF4wLjguNDsKCmNvbnRyYWN0IEFjY2Vzc1Jlc3RyaWN0aW9uIHsKICAgIC8vIEJ1bmxhciwgYG1zZy5zZW5kZXJgJ8SxbiBidSBzw7Z6bGXFn21leWkKICAgIC8vIG9sdcWfdHVyYW4gaGVzYXAgb2xkdcSfdSB5YXDEsW0gYcWfYW1hc8SxbmRhCiAgICAvLyBhdGFuYWNha3TEsXIuCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB1aW50IHB1YmxpYyBjcmVhdGlvblRpbWUgPSBibG9jay50aW1lc3RhbXA7CgogICAgLy8gQWx0dGEsIGJ1IHPDtnpsZcWfbWVuaW4gb2x1xZ90dXJhYmlsZWNlxJ9pCiAgICAvLyBoYXRhbGFyxLFuIGJpciBsaXN0ZXNpLCDDtnplbCB5b3J1bWxhcmRhCiAgICAvLyB5YXrEsWzEsSBiaXIgYcOnxLFrbGFtYXlsYSBiaXJsaWt0ZQogICAgLy8gdmVyaWxtacWfdGlyLgoKICAgIC8vLyBHw7ZuZGVyaWNpIGJ1IGnFn2xlbSBpw6dpbiB5ZXRraWxpCiAgICAvLy8gZGXEn2lsZGlyLgogICAgZXJyb3IgVW5hdXRob3JpemVkKCk7CgogICAgLy8vIEZvbmtzaXlvbiDDp29rIGVya2VuIMOnYcSfcsSxbGTEsS4KICAgIGVycm9yIFRvb0Vhcmx5KCk7CgogICAgLy8vIEZvbmtzaXlvbiDDp2HEn3LEsXPEsXlsYSB5ZXRlcmluY2UgRXRoZXIgZ8O2bmRlcmlsbWVkaS4KICAgIGVycm9yIE5vdEVub3VnaEV0aGVyKCk7CgogICAgLy8gTW9kaWZpZXInbGFyIGJpciBmb25rc2l5b251biBnw7Z2ZGVzaW5pCiAgICAvLyBkZcSfacWfdGlybWVrIGnDp2luIGt1bGxhbsSxbGFiaWxpci4KICAgIC8vIEJ1IG1vZGlmaWVyIGt1bGxhbsSxbMSxcnNhIGJhxZ9hLAogICAgLy8geWFsbsSxemNhIGZvbmtzaXlvbiBiZWxpcmxpIGJpcgogICAgLy8gYWRyZXN0ZW4gw6dhxJ9yxLFsZMSxxJ/EsW5kYSBnZcOnZW4gYmlyCiAgICAvLyBrb250cm9sIGVrbGV5ZWNla3Rpci4KICAgIG1vZGlmaWVyIG9ubHlCeShhZGRyZXNzIGFjY291bnQpCiAgICB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gYWNjb3VudCkKICAgICAgICAgICAgcmV2ZXJ0IFVuYXV0aG9yaXplZCgpOwogICAgICAgIC8vICJfOyIgacWfYXJldGluaSB1bnV0bWF5xLFuISBNb2RpZmllcgogICAgICAgIC8vIGt1bGxhbsSxbGTEscSfxLFuZGEgYnUsIGdlcsOnZWsgZm9ua3NpeW9uCiAgICAgICAgLy8gZ8O2dmRlc2kgaWxlIGRlxJ9pxZ90aXJpbGVjZWt0aXIuCiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8gYG5ld093bmVyYCfEsSBidSBzw7Z6bGXFn21lbmluIHllbmkKICAgIC8vLyBzYWhpYmkgeWFwxLFuLgogICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBuZXdPd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5Qnkob3duZXIpCiAgICB7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5QWZ0ZXIodWludCB0aW1lKSB7CiAgICAgICAgaWYgKGJsb2NrLnRpbWVzdGFtcCA8IHRpbWUpCiAgICAgICAgICAgIHJldmVydCBUb29FYXJseSgpOwogICAgICAgIF87CiAgICB9CgogICAgLy8vIFNhaGlwbGlrIGJpbGdpbGVyaW5pIHNpbGluLgogICAgLy8vIFlhbG7EsXpjYSBzw7Z6bGXFn21lIG9sdcWfdHVydWxkdWt0YW4KICAgIC8vLyA2IGhhZnRhIHNvbnJhIMOnYcSfcsSxbGFiaWxpci4KICAgIGZ1bmN0aW9uIGRpc293bigpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUJ5KG93bmVyKQogICAgICAgIG9ubHlBZnRlcihjcmVhdGlvblRpbWUgKyA2IHdlZWtzKQogICAgewogICAgICAgIGRlbGV0ZSBvd25lcjsKICAgIH0KCiAgICAvLyBCdSBtb2RpZmllciwgYmlyIGZvbmtzaXlvbiDDp2HEn3LEsXPEsW7EsW4gYmVsaXJsaQogICAgLy8gYmlyIMO8Y3JldGxlIGlsacWfa2lsZW5kaXJpbG1lc2luaSBnZXJla3RpcmlyLgogICAgLy8gw4dhxJ/EsXJhbiBracWfaSDDp29rIGZhemxhIGfDtm5kZXJtacWfc2UgeWFsbsSxemNhCiAgICAvLyBmb25rc2l5b24gZ8O2dmRlc2luZGVuIHNvbnJhc8SxIGlhZGUgZWRpbGlyLgogICAgLy8gQnUsIGBfO2Agc29ucmFzxLFuZGFraSBrxLFzbcSxIGF0bGFtYW7EsW4gbcO8bWvDvG4KICAgIC8vIG9sZHXEn3UgU29saWRpdHkgc8O8csO8bcO8IDAuNC4wIMO2bmNlc2luZGUgdGVobGlrZWxpeWRpLgogICAgbW9kaWZpZXIgY29zdHModWludCBhbW91bnQpIHsKICAgICAgICBpZiAobXNnLnZhbHVlIDwgYW1vdW50KQogICAgICAgICAgICByZXZlcnQgTm90RW5vdWdoRXRoZXIoKTsKCiAgICAgICAgXzsKICAgICAgICBpZiAobXNnLnZhbHVlID4gYW1vdW50KQogICAgICAgICAgICBwYXlhYmxlKG1zZy5zZW5kZXIpLnRyYW5zZmVyKG1zZy52YWx1ZSAtIGFtb3VudCk7CiAgICB9CgogICAgZnVuY3Rpb24gZm9yY2VPd25lckNoYW5nZShhZGRyZXNzIG5ld093bmVyKQogICAgICAgIHB1YmxpYwogICAgICAgIHBheWFibGUKICAgICAgICBjb3N0cygyMDAgZXRoZXIpCiAgICB7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgICAgICAvLyB5YWxuxLF6Y2Egw7ZybmVrIGJpciBrb8WfdWwKICAgICAgICBpZiAodWludDE2MChvd25lcikgJiAwID09IDEpCiAgICAgICAgICAgIC8vIFPDvHLDvG0gMC40LjAgw7ZuY2VzaW5kZSBidSwgU29saWRpdHkKICAgICAgICAgICAgLy8gaWFkZSB5YXBtxLF5b3JkdS4KICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIC8vIGZhemxhIMO2ZGVuZW4gw7xjcmV0bGVyaSBpYWRlIGV0CiAgICB9Cn0="><span class="link-icon"></span><span class="link-text">open in Remix</span></a></p>
<div class="highlight-solidity notranslate"><div class="highlight"><pre><span></span><span class="c1">// SPDX-License-Identifier: GPL-3.0</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.4</span><span class="p">;</span><span class="w"></span>

<span class="k">contract</span><span class="w"> </span><span class="ni">AccessRestriction</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Bunlar, `msg.sender`&#39;ın bu sözleşmeyi</span>
<span class="w">    </span><span class="c1">// oluşturan hesap olduğu yapım aşamasında</span>
<span class="w">    </span><span class="c1">// atanacaktır.</span>
<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="k">public </span><span class="nv">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.sender</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">creationTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">block.timestamp</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Altta, bu sözleşmenin oluşturabileceği</span>
<span class="w">    </span><span class="c1">// hataların bir listesi, özel yorumlarda</span>
<span class="w">    </span><span class="c1">// yazılı bir açıklamayla birlikte</span>
<span class="w">    </span><span class="c1">// verilmiştir.</span>

<span class="w">    </span><span class="c1">/// Gönderici bu işlem için yetkili</span>
<span class="w">    </span><span class="c1">/// değildir.</span>
<span class="w">    </span>error<span class="w"> </span>Unauthorized<span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">/// Fonksiyon çok erken çağrıldı.</span>
<span class="w">    </span>error<span class="w"> </span>TooEarly<span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">/// Fonksiyon çağrısıyla yeterince Ether gönderilmedi.</span>
<span class="w">    </span>error<span class="w"> </span>NotEnoughEther<span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Modifier&#39;lar bir fonksiyonun gövdesini</span>
<span class="w">    </span><span class="c1">// değiştirmek için kullanılabilir.</span>
<span class="w">    </span><span class="c1">// Bu modifier kullanılırsa başa,</span>
<span class="w">    </span><span class="c1">// yalnızca fonksiyon belirli bir</span>
<span class="w">    </span><span class="c1">// adresten çağrıldığında geçen bir</span>
<span class="w">    </span><span class="c1">// kontrol ekleyecektir.</span>
<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>onlyBy<span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">account</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.sender</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span>account<span class="p">)</span><span class="w"></span>
<span class="w">            </span>revert<span class="w"> </span>Unauthorized<span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="c1">// &quot;_;&quot; işaretini unutmayın! Modifier</span>
<span class="w">        </span><span class="c1">// kullanıldığında bu, gerçek fonksiyon</span>
<span class="w">        </span><span class="c1">// gövdesi ile değiştirilecektir.</span>
<span class="w">        </span>_<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">/// `newOwner`&#39;ı bu sözleşmenin yeni</span>
<span class="w">    </span><span class="c1">/// sahibi yapın.</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">changeOwner</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">newOwner</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="kt">public</span><span class="w"></span>
<span class="w">        </span>onlyBy<span class="p">(</span>owner<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>owner<span class="w"> </span><span class="o">=</span><span class="w"> </span>newOwner<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>onlyAfter<span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">time</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">block.timestamp</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>time<span class="p">)</span><span class="w"></span>
<span class="w">            </span>revert<span class="w"> </span>TooEarly<span class="p">();</span><span class="w"></span>
<span class="w">        </span>_<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">/// Sahiplik bilgilerini silin.</span>
<span class="w">    </span><span class="c1">/// Yalnızca sözleşme oluşturulduktan</span>
<span class="w">    </span><span class="c1">/// 6 hafta sonra çağrılabilir.</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">disown</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="kt">public</span><span class="w"></span>
<span class="w">        </span>onlyBy<span class="p">(</span>owner<span class="p">)</span><span class="w"></span>
<span class="w">        </span>onlyAfter<span class="p">(</span>creationTime<span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m m-Decimal">6</span><span class="w"> </span>weeks<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>delete<span class="w"> </span>owner<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Bu modifier, bir fonksiyon çağrısının belirli</span>
<span class="w">    </span><span class="c1">// bir ücretle ilişkilendirilmesini gerektirir.</span>
<span class="w">    </span><span class="c1">// Çağıran kişi çok fazla göndermişse yalnızca</span>
<span class="w">    </span><span class="c1">// fonksiyon gövdesinden sonrası iade edilir.</span>
<span class="w">    </span><span class="c1">// Bu, `_;` sonrasındaki kısmı atlamanın mümkün</span>
<span class="w">    </span><span class="c1">// olduğu Solidity sürümü 0.4.0 öncesinde tehlikeliydi.</span>
<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>costs<span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">amount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.value</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>amount<span class="p">)</span><span class="w"></span>
<span class="w">            </span>revert<span class="w"> </span>NotEnoughEther<span class="p">();</span><span class="w"></span>

<span class="w">        </span>_<span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.value</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>amount<span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="kt">payable</span><span class="p">(</span><span class="k">msg.sender</span><span class="p">).</span>transfer<span class="p">(</span><span class="k">msg.value</span><span class="w"> </span><span class="o">-</span><span class="w"> </span>amount<span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">forceOwnerChange</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">newOwner</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="kt">public</span><span class="w"></span>
<span class="w">        </span><span class="kt">payable</span><span class="w"></span>
<span class="w">        </span>costs<span class="p">(</span><span class="m m-Decimal">200</span><span class="w"> </span>ether<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>owner<span class="w"> </span><span class="o">=</span><span class="w"> </span>newOwner<span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="c1">// yalnızca örnek bir koşul</span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="kt">uint160</span><span class="p">(</span>owner<span class="p">)</span><span class="w"> </span><span class="err">&amp;</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Sürüm 0.4.0 öncesinde bu, Solidity</span>
<span class="w">            </span><span class="c1">// iade yapmıyordu.</span>
<span class="w">            </span><span class="kt">return</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="c1">// fazla ödenen ücretleri iade et</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Fonksiyon çağrılarına erişimin kısıtlanabileceği
daha özel bir yol, bir sonraki örnekte
incelenecektir.</p>
</section>
<section id="durum-makinesi">
<span id="index-3"></span><h2>Durum Makinesi<a class="headerlink" href="#durum-makinesi" title="Permalink to this heading"></a></h2>
<p>Sözleşmeler, sıklıkla, bir durum makinesi işlevi
görür; bu, içinde farklı davrandıkları veya farklı
fonksiyonların çağrılabildiği belirli <strong>aşamalara</strong>
sahip oldukları anlamına gelir.Bir fonksiyon çağrısı
genellikle bir aşamayı sonlandırır ve sözleşmeyi bir
sonraki aşamaya geçirir (özellikle sözleşme,
<strong>etkileşimi</strong> modellediğinde). Bazı aşamalara belirli
bir <strong>anda</strong> otomatik olarak ulaşılması da yaygındır.</p>
<p>Bunun bir örneği, “kör teklifleri kabul etme” aşamasından
başlayan, “teklifleri açıklama” aşamasına geçen ve “ihale
sonucunu belirleme” ile sonlanan kör ihale sözleşmesidir.</p>
<p id="index-4">Bu durumda, durumları modellemek ve sözleşmenin
yanlış kullanımına karşı korunmak için
fonksiyon modifier’ları kullanılabilir.</p>
<section id="ornek">
<h3>Örnek<a class="headerlink" href="#ornek" title="Permalink to this heading"></a></h3>
<p>Aşağıdaki örnekte,
<code class="docutils literal notranslate"><span class="pre">atStage</span></code> modifier’ı fonksiyonun yalnızca
belirli bir aşamada çağrılmasını sağlar.</p>
<p>Otomatik zaman ayarlı geçişler, tüm fonksiyonlar
tarafından kullanılması gereken <code class="docutils literal notranslate"><span class="pre">timedTransitions</span></code>
modifier’ı ele alınır.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Modifier Sırası Önemlidir</strong>.
atStage, timedTransitions ile birleştirilirse
yeni aşamanın dikkate alınması için atStage’i
timedTransitions’tan sonra belirttiğinizden
emin olun.</p>
</div>
<p>Son olarak, fonksiyon sonlandığında otomatik olarak
bir sonraki aşamaya gitmek için <code class="docutils literal notranslate"><span class="pre">transitionNext</span></code>
modifier’ı kullanılabilir.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Modifier Atlanabilir</strong>.
Bu, yalnızca 0.4.0 öncesi Solidity sürümlerinde geçerlidir:
Modifier’lar, fonksiyon çağrısı kullanarak değil,
yalnızca kodu değiştirerek uygulandığından fonksiyonun
kendisi return kullanırsa transitionNext modifier’ındaki
kod atlanabilir. Bunu yapmak isterseniz nextStage’i o
fonksiyonlardan manuel olarak çağırdığınızdan emin
olun. 0.4.0 sürümünden itibaren modifier kodu, fonksiyon
açıkça retun etse dahi çalışacaktır.</p>
</div>
<p class="remix-link-container"><a class="remix-link reference external" href="https://remix.ethereum.org/?language=solidity&amp;version=0.8.15&amp;code=Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0zLjAKcHJhZ21hIHNvbGlkaXR5IF4wLjguNDsKCmNvbnRyYWN0IFN0YXRlTWFjaGluZSB7CiAgICBlbnVtIFN0YWdlcyB7CiAgICAgICAgQWNjZXB0aW5nQmxpbmRlZEJpZHMsCiAgICAgICAgUmV2ZWFsQmlkcywKICAgICAgICBBbm90aGVyU3RhZ2UsCiAgICAgICAgQXJlV2VEb25lWWV0LAogICAgICAgIEZpbmlzaGVkCiAgICB9CiAgICAvLy8gQnUgbm9rdGFkYSBmb25rc2l5b24gw6dhxJ9yxLFsYW1hei4KICAgIGVycm9yIEZ1bmN0aW9uSW52YWxpZEF0VGhpc1N0YWdlKCk7CgogICAgLy8gTWV2Y3V0IGHFn2FtYSBidWR1ci4KICAgIFN0YWdlcyBwdWJsaWMgc3RhZ2UgPSBTdGFnZXMuQWNjZXB0aW5nQmxpbmRlZEJpZHM7CgogICAgdWludCBwdWJsaWMgY3JlYXRpb25UaW1lID0gYmxvY2sudGltZXN0YW1wOwoKICAgIG1vZGlmaWVyIGF0U3RhZ2UoU3RhZ2VzIHN0YWdlXykgewogICAgICAgIGlmIChzdGFnZSAhPSBzdGFnZV8pCiAgICAgICAgICAgIHJldmVydCBGdW5jdGlvbkludmFsaWRBdFRoaXNTdGFnZSgpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gbmV4dFN0YWdlKCkgaW50ZXJuYWwgewogICAgICAgIHN0YWdlID0gU3RhZ2VzKHVpbnQoc3RhZ2UpICsgMSk7CiAgICB9CgogICAgLy8gWmFtYW4gYXlhcmzEsSBnZcOnacWfbGVyIGdlcsOnZWtsZcWfdGlyaW4uIMOWbmNlIGJ1CiAgICAvLyBtb2RpZmllcifEsSBiZWxpcnR0acSfaW5pemRlbiBlbWluIG9sdW4gYWtzaSBoYWxkZQogICAgLy8ga29ydW1hbGFyIHllbmkgYcWfYW1hecSxIGRpa2thdGUgYWxtYXouCiAgICBtb2RpZmllciB0aW1lZFRyYW5zaXRpb25zKCkgewogICAgICAgIGlmIChzdGFnZSA9PSBTdGFnZXMuQWNjZXB0aW5nQmxpbmRlZEJpZHMgJiYKICAgICAgICAgICAgICAgICAgICBibG9jay50aW1lc3RhbXAgPj0gY3JlYXRpb25UaW1lICsgMTAgZGF5cykKICAgICAgICAgICAgbmV4dFN0YWdlKCk7CiAgICAgICAgaWYgKHN0YWdlID09IFN0YWdlcy5SZXZlYWxCaWRzICYmCiAgICAgICAgICAgICAgICBibG9jay50aW1lc3RhbXAgPj0gY3JlYXRpb25UaW1lICsgMTIgZGF5cykKICAgICAgICAgICAgbmV4dFN0YWdlKCk7CiAgICAgICAgLy8gRGnEn2VyIGHFn2FtYWxhciBpxZ9sZW1lIGfDtnJlIGdlw6dpxZ8geWFwYXIKICAgICAgICBfOwogICAgfQoKICAgIC8vIEJ1cmFkYSBtb2RpZmllcidsYXLEsW4gc8SxcmFzxLEgw7ZuZW1saWRpciEKICAgIGZ1bmN0aW9uIGJpZCgpCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZQogICAgICAgIHRpbWVkVHJhbnNpdGlvbnMKICAgICAgICBhdFN0YWdlKFN0YWdlcy5BY2NlcHRpbmdCbGluZGVkQmlkcykKICAgIHsKICAgICAgICAvLyBPbnUgYnVyYWRhIHV5Z3VsYW1heWFjYcSfxLF6CiAgICB9CgogICAgZnVuY3Rpb24gcmV2ZWFsKCkKICAgICAgICBwdWJsaWMKICAgICAgICB0aW1lZFRyYW5zaXRpb25zCiAgICAgICAgYXRTdGFnZShTdGFnZXMuUmV2ZWFsQmlkcykKICAgIHsKICAgIH0KCiAgICAvLyBCdSBtb2RpZmllciwgZm9ua3NpeW9udW4gdGFtYW1sYW5tYXPEsW7EsW4KICAgIC8vIGFyZMSxbmRhbiBzb25yYWtpIGHFn2FtYXlhIGdlw6dlci4KICAgIG1vZGlmaWVyIHRyYW5zaXRpb25OZXh0KCkKICAgIHsKICAgICAgICBfOwogICAgICAgIG5leHRTdGFnZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGcoKQogICAgICAgIHB1YmxpYwogICAgICAgIHRpbWVkVHJhbnNpdGlvbnMKICAgICAgICBhdFN0YWdlKFN0YWdlcy5Bbm90aGVyU3RhZ2UpCiAgICAgICAgdHJhbnNpdGlvbk5leHQKICAgIHsKICAgIH0KCiAgICBmdW5jdGlvbiBoKCkKICAgICAgICBwdWJsaWMKICAgICAgICB0aW1lZFRyYW5zaXRpb25zCiAgICAgICAgYXRTdGFnZShTdGFnZXMuQXJlV2VEb25lWWV0KQogICAgICAgIHRyYW5zaXRpb25OZXh0CiAgICB7CiAgICB9CgogICAgZnVuY3Rpb24gaSgpCiAgICAgICAgcHVibGljCiAgICAgICAgdGltZWRUcmFuc2l0aW9ucwogICAgICAgIGF0U3RhZ2UoU3RhZ2VzLkZpbmlzaGVkKQogICAgewogICAgfQp9"><span class="link-icon"></span><span class="link-text">open in Remix</span></a></p>
<div class="highlight-solidity notranslate"><div class="highlight"><pre><span></span><span class="c1">// SPDX-License-Identifier: GPL-3.0</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.4</span><span class="p">;</span><span class="w"></span>

<span class="k">contract</span><span class="w"> </span><span class="ni">StateMachine</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">enum</span><span class="w"> </span><span class="nv">Stages</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>AcceptingBlindedBids<span class="p">,</span><span class="w"></span>
<span class="w">        </span>RevealBids<span class="p">,</span><span class="w"></span>
<span class="w">        </span>AnotherStage<span class="p">,</span><span class="w"></span>
<span class="w">        </span>AreWeDoneYet<span class="p">,</span><span class="w"></span>
<span class="w">        </span>Finished<span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c1">/// Bu noktada fonksiyon çağrılamaz.</span>
<span class="w">    </span>error<span class="w"> </span>FunctionInvalidAtThisStage<span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Mevcut aşama budur.</span>
<span class="w">    </span>Stages<span class="w"> </span><span class="kt">public</span><span class="w"> </span>stage<span class="w"> </span><span class="o">=</span><span class="w"> </span>Stages<span class="p">.</span>AcceptingBlindedBids<span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">creationTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">block.timestamp</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>atStage<span class="p">(</span>Stages<span class="w"> </span>stage_<span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>stage<span class="w"> </span><span class="o">!=</span><span class="w"> </span>stage_<span class="p">)</span><span class="w"></span>
<span class="w">            </span>revert<span class="w"> </span>FunctionInvalidAtThisStage<span class="p">();</span><span class="w"></span>
<span class="w">        </span>_<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">nextStage</span><span class="p">()</span><span class="w"> </span><span class="kt">internal</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>stage<span class="w"> </span><span class="o">=</span><span class="w"> </span>Stages<span class="p">(</span><span class="kt">uint</span><span class="p">(</span>stage<span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Zaman ayarlı geçişler gerçekleştirin. Önce bu</span>
<span class="w">    </span><span class="c1">// modifier&#39;ı belirttiğinizden emin olun aksi halde</span>
<span class="w">    </span><span class="c1">// korumalar yeni aşamayı dikkate almaz.</span>
<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>timedTransitions<span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>stage<span class="w"> </span><span class="o">==</span><span class="w"> </span>Stages<span class="p">.</span>AcceptingBlindedBids<span class="w"> </span><span class="err">&amp;&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="k">block.timestamp</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span>creationTime<span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m m-Decimal">10</span><span class="w"> </span>days<span class="p">)</span><span class="w"></span>
<span class="w">            </span>nextStage<span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>stage<span class="w"> </span><span class="o">==</span><span class="w"> </span>Stages<span class="p">.</span>RevealBids<span class="w"> </span><span class="err">&amp;&amp;</span><span class="w"></span>
<span class="w">                </span><span class="k">block.timestamp</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span>creationTime<span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m m-Decimal">12</span><span class="w"> </span>days<span class="p">)</span><span class="w"></span>
<span class="w">            </span>nextStage<span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Diğer aşamalar işleme göre geçiş yapar</span>
<span class="w">        </span>_<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Burada modifier&#39;ların sırası önemlidir!</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">bid</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="kt">public</span><span class="w"></span>
<span class="w">        </span><span class="kt">payable</span><span class="w"></span>
<span class="w">        </span>timedTransitions<span class="w"></span>
<span class="w">        </span>atStage<span class="p">(</span>Stages<span class="p">.</span>AcceptingBlindedBids<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Onu burada uygulamayacağız</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">reveal</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="kt">public</span><span class="w"></span>
<span class="w">        </span>timedTransitions<span class="w"></span>
<span class="w">        </span>atStage<span class="p">(</span>Stages<span class="p">.</span>RevealBids<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Bu modifier, fonksiyonun tamamlanmasının</span>
<span class="w">    </span><span class="c1">// ardından sonraki aşamaya geçer.</span>
<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>transitionNext<span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>_<span class="p">;</span><span class="w"></span>
<span class="w">        </span>nextStage<span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">g</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="kt">public</span><span class="w"></span>
<span class="w">        </span>timedTransitions<span class="w"></span>
<span class="w">        </span>atStage<span class="p">(</span>Stages<span class="p">.</span>AnotherStage<span class="p">)</span><span class="w"></span>
<span class="w">        </span>transitionNext<span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">h</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="kt">public</span><span class="w"></span>
<span class="w">        </span>timedTransitions<span class="w"></span>
<span class="w">        </span>atStage<span class="p">(</span>Stages<span class="p">.</span>AreWeDoneYet<span class="p">)</span><span class="w"></span>
<span class="w">        </span>transitionNext<span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">i</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="kt">public</span><span class="w"></span>
<span class="w">        </span>timedTransitions<span class="w"></span>
<span class="w">        </span>atStage<span class="p">(</span>Stages<span class="p">.</span>Finished<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="style-guide.html" class="btn btn-neutral float-left" title="Style Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bugs.html" class="btn btn-neutral float-right" title="Bilinen Bugların Listesi" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2021, Ethereum.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
    <p>
        <a href="credits-and-attribution.html">Credits and attribution</a>.
    </p>


</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book fa-element"> RTD </span>

    <span class="fa fa-element">
    <input class="container_toggle" type="checkbox" id="switch" name="mode">
    <label for="switch"></label>
    </span>

    <span class="fa fa-v fa-element"> v:  <span class="fa fa-caret-down"></span></span>

    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Downloads</dt> 
        </dl>
        <dl>
            <dt>Versions</dt> 
        </dl>
        <dl>
            
            <dt>On Read the Docs</dt>
            <dd>
                <a href="///projects//?fromdocs=">Project Home</a>
            </dd>
            <dd>
                <a href="///builds//?fromdocs=">Builds</a>
            </dd>
        </dl>
    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>